{"version":3,"sources":["webpack://@aradeid/discussion-to-source/webpack/bootstrap","webpack://@aradeid/discussion-to-source/./forum.js","webpack://@aradeid/discussion-to-source/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@aradeid/discussion-to-source/./src/forum/components/ChangeLinkModal.js","webpack://@aradeid/discussion-to-source/./src/forum/components/ChangeThumbnailModal.js","webpack://@aradeid/discussion-to-source/./src/forum/components/GoogleSearchModal.js","webpack://@aradeid/discussion-to-source/./src/forum/index.js","webpack://@aradeid/discussion-to-source/./src/forum/utils/LinkUtils.js","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['Component']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['Model']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/Button']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/DiscussionComposer']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/DiscussionList']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/DiscussionsSearchSource']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/Modal']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['components/TextEditor']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['extend']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['utils/Stream']\"","webpack://@aradeid/discussion-to-source/external \"flarum.core.compat['utils/extractText']\""],"names":["ChangeLinkModal","oninit","vnode","discussion","attrs","currentLink","data","attributes","link","newLink","Stream","className","title","app","translator","trans","content","Button","component","type","loading","onsubmit","e","preventDefault","LinkUtils","AddProtocolToLink","save","then","viewingDiscussion","current","get","update","m","redraw","hide","Modal","ChangeThumbnailModal","currentThumbnail","thumbnail","newThumbnail","GoogleSearchModal","view","key","Component","initializers","add","DiscussionListItem","prototype","sourceThumbnail","Model","attribute","extend","discId","children","href","split","pop","store","getBy","image","getFirstImage","firstPost","target","unshift","DiscussionComposer","linkPlaceholder","extractText","thumbnailPlaceholder","items","bidi","placeholder","onkeydown","bind","DiscussionPage","DiscussionControls","canRename","icon","onclick","changeLinkAction","changeThumbnailAction","route","TextEditor","setThumbnail","DiscussionList","appPath","appName","param","set","search","hidePlaceholder","push","modal","show","currentTitle","counter","checkExist","setInterval","clearInterval","dom","classList","value","regex","images","match","console","log","input","$","val","post","defaultImg","forum","src","exec","contentHtml"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\r\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Modal from 'flarum/components/Modal';\r\nimport Button from 'flarum/components/Button';\r\nimport Stream from 'flarum/utils/Stream';\r\nimport LinkUtils from '../utils/LinkUtils'\r\n\r\nexport default class ChangeLinkModal extends Modal {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.discussion = this.attrs.discussion;\r\n    this.currentLink = this.attrs.discussion.data.attributes.link;\r\n    this.newLink = Stream(this.currentLink);\r\n  }\r\n\r\n  className() {\r\n    return 'ChangeLinkModal Modal--small';\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans('aradeid-d2s.forum.change_link_discussion.title');\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"Modal-body\">\r\n        <div className=\"Form Form--centered\">\r\n          <div className=\"Form-group\">\r\n            <input className=\"FormControl\" bidi={this.newLink} type=\"text\" />\r\n          </div>\r\n          <div className=\"Form-group\">\r\n            {Button.component(\r\n              {\r\n                className: 'Button Button--primary Button--block',\r\n                type: 'submit',\r\n                loading: this.loading,\r\n              },\r\n              app.translator.trans('aradeid-d2s.forum.change_link_discussion.submit_button')\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    this.loading = true;\r\n\r\n    var link = this.newLink;\r\n    var currentLink = this.currentLink;\r\n\r\n    if (link && link !== currentLink) {\r\n      link = LinkUtils.AddProtocolToLink(link);\r\n      return this.discussion\r\n        .save({ link })\r\n        .then(() => {\r\n          if (app.viewingDiscussion(this.discussion)) {\r\n            app.current.get('stream').update();\r\n          }\r\n          m.redraw();\r\n          this.hide();\r\n        })\r\n        .catch(() => {\r\n          this.loading = false;\r\n          m.redraw();\r\n        });\r\n    } else {\r\n      this.hide();\r\n    }\r\n  }\r\n}\r\n","import Modal from 'flarum/components/Modal';\r\nimport Button from 'flarum/components/Button';\r\nimport Stream from 'flarum/utils/Stream';\r\nimport LinkUtils from '../utils/LinkUtils';\r\n\r\nexport default class ChangeThumbnailModal extends Modal {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.discussion = this.attrs.discussion;\r\n    this.currentThumbnail = this.attrs.discussion.data.attributes.thumbnail;\r\n    this.newThumbnail = Stream(this.currentThumbnail);\r\n  }\r\n\r\n  className() {\r\n    return 'ChangeThumbnailModal Modal--small';\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans('aradeid-d2s.forum.change_thumbnail_discussion.title');\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"Modal-body\">\r\n        <div className=\"Form Form--centered\">\r\n          <div className=\"Form-group\">\r\n            <input className=\"FormControl\" bidi={this.newThumbnail} type=\"text\" />\r\n          </div>\r\n          <div className=\"Form-group\">\r\n            {Button.component(\r\n              {\r\n                className: 'Button Button--primary Button--block',\r\n                type: 'submit',\r\n                loading: this.loading,\r\n              },\r\n              app.translator.trans('aradeid-d2s.forum.change_thumbnail_discussion.submit_button')\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    this.loading = true;\r\n\r\n    var thumbnail = this.newThumbnail();\r\n    var currentThumbnail = this.currentThumbnail;\r\n\r\n    if (thumbnail && thumbnail !== currentThumbnail) {\r\n      thumbnail = LinkUtils.AddProtocolToLink(thumbnail)\r\n      return this.discussion\r\n        .save({ thumbnail })\r\n        .then(() => {\r\n          if (app.viewingDiscussion(this.discussion)) {\r\n            app.current.get('stream').update();\r\n          }\r\n          m.redraw();\r\n          this.hide();\r\n        })\r\n        .catch(() => {\r\n          this.loading = false;\r\n          m.redraw();\r\n        });\r\n    } else {\r\n      this.hide();\r\n    }\r\n  }\r\n}","import Modal from 'flarum/components/Modal';\r\nimport Component from 'flarum/Component';\r\n\r\nexport default class GoogleSearchModal extends Component {\r\n//export default class GoogleSearchModal extends Modal {\r\n  view() {\r\n    this.key = this.attrs.key;\r\n    return (\r\n        <div className=\"Resource-search-results sideNavOffset\">\r\n            <script async src={\"https://cse.google.com/cse.js?cx=\" + this.key}></script>\r\n            <div className=\"gcse-searchresults-only\" defaultToImageSearch=\"true\"></div>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n","import { extend } from \"flarum/extend\";\r\nimport DiscussionListItem from 'flarum/components/DiscussionListItem';\r\nimport Model from \"flarum/Model\";\r\nimport DiscussionComposer from 'flarum/components/DiscussionComposer';\r\nimport Stream from 'flarum/utils/Stream';\r\nimport extractText from 'flarum/utils/extractText';\r\nimport DiscussionPage from 'flarum/components/DiscussionPage';\r\nimport DiscussionControls from \"flarum/utils/DiscussionControls\";\r\nimport Button from 'flarum/components/Button';\r\nimport ChangeLinkModal from './components/ChangeLinkModal';\r\nimport ChangeThumbnailModal from './components/ChangeThumbnailModal';\r\nimport DiscussionsSearchSource from \"flarum/components/DiscussionsSearchSource\";\r\nimport DiscussionList from 'flarum/components/DiscussionList';\r\nimport TextEditor from 'flarum/components/TextEditor';\r\nimport GoogleSearchModal from './components/GoogleSearchModal';\r\nimport LinkUtils from './utils/LinkUtils';\r\n\r\nvar link;\r\nvar thumbnail;\r\nvar attrs = {};\r\n\r\napp.initializers.add('aradeid/discussion-to-source', () => {\r\n\r\n  DiscussionListItem.prototype.sourceThumbnail = Model.attribute(\"sourceThumbnail\");\r\n  extend(DiscussionListItem.prototype, 'view', function (view) {\r\n    var discId = view.children[2].children[2].attrs.href.split('/').pop().split('-')[0];\r\n    var discussion = app.store.getBy('discussions', 'id', discId);\r\n    if (discussion && discussion.data) {\r\n      var link = discussion.data.attributes.link;\r\n      var thumbnail = discussion.data.attributes.thumbnail;\r\n      var image = getFirstImage(discussion.firstPost());\r\n      if (link) {\r\n        // set image to external link\r\n        view.children[2].children[0].attrs.href = link;\r\n        view.children[2].children[0].attrs.target = '_blank';\r\n        // set discussion title to external link\r\n        view.children[2].children[2].attrs.href = link;\r\n        view.children[2].children[2].attrs.target = '_blank';\r\n      } else {\r\n        // set image to discussion link; since the default destination is author's profile\r\n        view.children[2].children[0].attrs.href = view.children[2].children[2].attrs.href;\r\n      }\r\n\r\n      if(thumbnail) {\r\n        view.children[2].children[0].children.unshift(<img class='sourceThumbnail' src={thumbnail}/>);\r\n      } else {\r\n        view.children[2].children[0].children.unshift(<img class='sourceThumbnail' src={image}/>);\r\n      }\r\n    }\r\n    \r\n    \r\n  });\r\n\r\n  extend(DiscussionComposer.prototype, 'oninit', () => {\r\n    link = Stream(attrs.link);\r\n    thumbnail = Stream(attrs.thumbnail);\r\n    attrs.linkPlaceholder = extractText(app.translator.trans('aradeid-d2s.forum.discussion_composer.link_placeholder'));\r\n    attrs.thumbnailPlaceholder = extractText(app.translator.trans('aradeid-d2s.forum.discussion_composer.thumbnail_placeholder'));\r\n  });\r\n\r\n  extend(DiscussionComposer.prototype, 'headerItems', (items) => {\r\n    items.add(\r\n      'discussionLink',\r\n      m('h3',\r\n        m('input', {\r\n          className: \"FormControl\",\r\n          bidi: link,\r\n          placeholder: attrs.linkPlaceholder,\r\n          //disabled={this.loading}\r\n          onkeydown: DiscussionComposer.prototype.onkeydown.bind(DiscussionComposer.prototype),\r\n        })\r\n      )\r\n    ).add(\r\n      'discussionThumbnail',\r\n      m('h3',\r\n        m('input', {\r\n          className: \"FormControl\",\r\n          bidi: thumbnail,\r\n          placeholder: attrs.thumbnailPlaceholder,\r\n          //disabled={this.loading}\r\n          onkeydown: DiscussionComposer.prototype.onkeydown.bind(DiscussionComposer.prototype),\r\n        })\r\n      )\r\n    );\r\n  });\r\n\r\n  extend(DiscussionComposer.prototype, 'data', (data) => {\r\n    data.link = LinkUtils.AddProtocolToLink(link());\r\n    data.thumbnail = LinkUtils.AddProtocolToLink(thumbnail());\r\n  });\r\n\r\n  extend(DiscussionPage.prototype, 'oninit', () => {\r\n    //m.route.set(app.routes.index.path);\r\n  });\r\n\r\n  extend(DiscussionControls, 'moderationControls', (items, discussion) => {\r\n    if (discussion.canRename()) {\r\n      items.add(\r\n        'changeLink',\r\n        Button.component(\r\n          {\r\n            icon: 'fas fa-link',\r\n            onclick: changeLinkAction.bind(discussion),\r\n          },\r\n          app.translator.trans('aradeid-d2s.forum.discussion_controls.change_link_button')\r\n        )\r\n      ).add(\r\n        'changeThumbnail',\r\n        Button.component(\r\n          {\r\n            icon: 'fas fa-image',\r\n            onclick: changeThumbnailAction.bind(discussion),\r\n          },\r\n          app.translator.trans('aradeid-d2s.forum.discussion_controls.change_thumbnail_button')\r\n        )\r\n      ) \r\n    }\r\n    items.add(\r\n      'checkDiscussionDetails',\r\n      Button.component(\r\n        {\r\n          icon: 'fas fa-info'\r\n        },\r\n        m('a', { href: app.route.discussion(discussion)}, app.translator.trans('aradeid-d2s.forum.discussion_controls.see_details_button'))\r\n      )\r\n    )\r\n  });\r\n  /*\r\n  extend(TextEditor.prototype, 'view', (view) => {\r\n    console.log(view.children[0].attrs = vnode => {console.log($(vnode.dom))})//.onblur = m.withAttr('value', setThumbnail);\r\n  });*/\r\n  \r\n  extend(TextEditor.prototype, 'oninput', setThumbnail);\r\n  extend(DiscussionList.prototype, 'view', (view) => {\r\n    var route = m.route.get().split('?')[0].split('/');\r\n    var appPath = route.pop();\r\n    var appName = route.pop();\r\n    \r\n    // check if route is a tag slug\r\n    if (appName == 't') {\r\n      // adds a google search component if the tag is relevant\r\n      if (appPath == 'studenti') {\r\n        if (!m.route.param('search')) {\r\n          m.route.set(m.route.get(), {search: 'studenți'});\r\n        }\r\n        hidePlaceholder(view);\r\n        view.children.push(GoogleSearchModal.component({key: '2568432f39b604615'}));\r\n      }\r\n      if (appPath == 'parinti') {\r\n        if (!m.route.param('search')) {\r\n          m.route.set(m.route.get(), {search: 'părinți'});\r\n        }\r\n        hidePlaceholder(view);\r\n        view.children.push(GoogleSearchModal.component({key: '864d2c85b6042671d'}));\r\n      }\r\n      if (appPath == 'elevi') {\r\n        if (!m.route.param('search')) {\r\n          m.route.set(m.route.get(), {search: 'elevi'});\r\n        }\r\n        hidePlaceholder(view);\r\n        view.children.push(GoogleSearchModal.component({key: '421118c66a83ddb25'}));\r\n      }\r\n    }\r\n  })\r\n});\r\n\r\n/**\r\n * Change discussion link.\r\n *\r\n * @return {Promise}\r\n */\r\nfunction changeLinkAction() {\r\n  return app.modal.show(ChangeLinkModal, {\r\n    currentTitle: this.title(),\r\n    discussion: this,\r\n  });\r\n}\r\n\r\n/**\r\n * Change discussion thumbnail.\r\n *\r\n * @return {Promise}\r\n */\r\nfunction changeThumbnailAction() {\r\n  return app.modal.show(ChangeThumbnailModal, {\r\n    currentTitle: this.title(),\r\n    discussion: this,\r\n  });\r\n}\r\n\r\nfunction hidePlaceholder(view) {\r\n  var counter = 0;\r\n  var checkExist = setInterval(function() {\r\n    if (counter >= 100) {// item never appeared after 10 seconds, therefore script should be stopped to avoid overflow\r\n      clearInterval(checkExist);\r\n    }\r\n    counter++;\r\n    if (view.children[0].dom) {\r\n      if (view.children[0].dom.classList[0] == 'Placeholder') {\r\n        view.children[0].dom.attributes[0].value = 'Placeholder hidden';\r\n      }\r\n      clearInterval(checkExist);\r\n    }\r\n    \r\n  }, 100);\r\n}\r\n\r\nfunction setThumbnail(e, data) {\r\n  var regex = /(?<=\\[upl-image-preview url=)([\\w\\d:/\\.&\\?\\-_\\/~]*)(?=\\])/g\r\n  var images = data.match(regex);console.log(this.value);\r\n  var input = $('.item-discussionThumbnail .FormControl');\r\n  if (input.val() == '' && images) {\r\n    input.val(images[0]);\r\n  } \r\n}\r\n\r\nfunction getFirstImage(post) {\r\n  const regex = /<img(?!.*?class=\"emoji\").*?src=[\\'\"](.*?)[\\'\"].*?>/;\r\n  const defaultImg = app.forum.attribute('defaultImg');\r\n  if (post) {\r\n    const src = regex.exec(post.contentHtml());\r\n    return (src) ? src[1] : defaultImg;\r\n  } else {\r\n    return defaultImg;\r\n  }\r\n}","export default class LinkUtils {\r\n\r\n    static AddProtocolToLink(link) {console.log(link);\r\n        if (link && link[0] != '/' && link.split('/')[0] != 'http' && link.split('/')[0] != 'https') {\r\n            return 'http://' + link;\r\n        }\r\n        return link;\r\n    }\r\n}","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionComposer'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/DiscussionsSearchSource'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/TextEditor'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['utils/Stream'];","module.exports = flarum.core.compat['utils/extractText'];"],"sourceRoot":""}